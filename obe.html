<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>OBE Calculation Sheet (CIE & SEE)</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;padding:20px;max-width:1100px;margin:auto}
    header{display:flex;align-items:center;gap:20px}
    header img{height:80px}
    h1{margin:0}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;align-items:center}
    label{font-weight:600;font-size:0.95rem}
    input,select{padding:6px 8px;width:100%;box-sizing:border-box}
    button{padding:8px 12px;margin-top:8px;cursor:pointer}
    table{border-collapse:collapse;width:100%;margin-top:12px}
    th,td{border:1px solid #ddd;padding:6px;text-align:center}
    .co-targets{display:flex;gap:8px;flex-wrap:wrap}
    .co-targets div{min-width:110px}
    .section-title{margin-top:18px;font-weight:700}
    .result-block{overflow:auto;margin-top:12px}
    .controls{margin-top:10px}
    hr{margin:20px 0}
    @media print { input,button,select,#fileInputCIE,#fileInputSEE{display:none!important} }

h1{margin-bottom:8px}
    .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
    label{font-weight:600}
    input[type="number"]{padding:6px;width:100px}
    .co-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;align-items:center;margin-top:12px}
    .co-grid .heading{font-weight:700;text-align:center}
    .section{margin-top:18px;padding:12px;border:1px solid #ddd;border-radius:6px}
    table{border-collapse:collapse;width:100%;margin-top:12px}
    th,td{border:1px solid #ccc;padding:6px;text-align:center}
    #chartWrap{width:100%;max-width:900px;margin-top:18px}
    button{padding:8px 12px;margin-top:8px;cursor:pointer}
    .small{font-size:0.9rem;color:#444}

body{
    font-family:Arial,Helvetica,sans-serif;
    padding:20px;
    max-width:1100px;
    margin:auto;
    margin-top:20px; /* prevents menu overlap */
}

.info-grid {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 8px;
  margin-top: 10px;
}

.to-delete {
    background-color: #ffcccc; /* light red for missing USNs */
}

.sno-error {
    background-color: #fff2b3; /* light yellow for S.No. mismatch */
}
 </style>
</head>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<body>

<!-- Simple Navigation Bar -->
<nav style="background:#004aad; padding:10px 20px; color:#fff; display:flex; justify-content:space-between; align-items:center;">
  <div style="font-size:1.2rem; font-weight:600;">Outcome Based Education System</div>
  <div style="display:flex; gap:20px;">
    <a href="index.html" style="color:white; text-decoration:none;">Home</a>
    <a href="obe.html" style="color:white; text-decoration:none;">OBE Calculation</a>
    <a href="co_extract.html" style="color:white; text-decoration:none;">CO Extraction</a>
  </div>
</nav>
<br/>
<header>
  <!-- Put jssstu_header.jpg in the same folder as this HTML -->
   <img src="jssstu_header.jpg" alt="University Header" id="uniHeader" onerror="this.style.display='none'"/>

  <div style="width:100%">
    <h1>OBE Calculation Sheet</h1>
    <div style="font-size:0.9rem">Set CO targets and compute attainment for CIE and SEE.</div>
  </div>
</header>

<section style="margin-top:12px">
  <!-- Course metadata -->
  <div class="grid">
    <div><label>Department Name</label><input id="deptname" placeholder="Enter Department Name"></div>
    <div><label>Course Coordinator</label><input id="coordinator" placeholder="Prof. ..."></div>
    <div><label>Department</label><input id="department" placeholder="Electronics and Communication Engineering"></div>
    <div><label>Academic Year</label><input id="acyear" placeholder="2023-24"></div>
    <div><label>UG/PG</label><input id="ugpg" placeholder="UG or PG"></div>
    <div><label>Semester</label><input id="semester" placeholder="Enter Semester"></div>
    <div><label>Section</label><input id="section" placeholder="Enter Section"></div>
    <div><label>Course Code</label><input id="coursecode" placeholder="20EC736"></div>
    <div><label>Course Name</label><input id="coursename" placeholder="Enter Course Name"></div>
    <div><label>Number of COs</label><input id="numcos" type="number" min="1" max="12" placeholder="e.g., 4"></div>
    <div><label>Number of Students (template)</label><input id="numstudents" type="number" min="1" placeholder="60"></div>
  </div>

  <hr>

  <!-- Download template control (creates a template matching current numcos) -->
  <div style="margin-bottom:12px">
    <button id="downloadTemplate">Download Excel Template</button>
    <button id="resetAll" style="margin-left:12px; background:#f66; color:#fff">Reset All</button>
  </div>

  <hr>

  <!-- CIE -->
  <div class="section-title">Set Targets (CIE)</div>
  <div class="co-targets" id="targetsContainerCIE"></div>
  <div style="margin-top:10px">
    <input type="file" id="fileInputCIE" accept=".xlsx,.xls,.csv">
    <button id="parseFileCIE">Parse & Compute CIE</button>
   <!--  <button id="printReportCIE" style="margin-left:8px">Print CIE</button>-->
  </div>
  <div id="uploadedTableCIE" class="result-block"></div>
  <div id="summaryTableCIE" class="result-block"></div>

  <hr>

  <!-- SEE -->
  <div class="section-title">Set Targets (SEE)</div>
  <div class="co-targets" id="targetsContainerSEE"></div>
  <div style="margin-top:10px">
    <input type="file" id="fileInputSEE" accept=".xlsx,.xls,.csv">
    <button id="parseFileSEE">Parse & Compute SEE</button>
    <!-- <button id="printReportSEE" style="margin-left:8px">Print SEE</button>-->
  </div>
  <div id="uploadedTableSEE" class="result-block"></div>
  <div id="summaryTableSEE" class="result-block"></div>





<h1>CO Weighted Calculation (CIE / SEE + Indirect Feedback)</h1>

  
<!-- Weight inputs -->
<div class="section">
  <div class="row">

    <div>
      <label for="cieWeight">CIE Weight (%)</label><br>
      <input id="cieWeight" type="number" min="0" max="100" value="50">
    </div>

    <div>
      <label for="seeWeight">SEE Weight (%)</label><br>
      <input id="seeWeight" type="number" min="0" max="100" value="50">
    </div>

    <div>
      <label for="directWeight">Direct Weight (%)</label><br>
      <input id="directWeight" type="number" min="0" max="100" value="80">
    </div>

    <div>
      <label>Indirect Weight (%)</label><br>
      <input id="indirectWeight" type="number" min="0" max="100" value="20">
    </div>

    <div style="min-width:240px">
      <div class="small">
        Indirect feedback = Score 1–5 (converted to percentage automatically)
        <br>
        Final = (CIE/SEE weighted) × Direct + Indirect% × Indirect
      </div>
    </div>

    <div style="margin-left:auto">
      <button id="computeBtn">Compute</button>
      <button id="clearBtn" style="margin-left:8px">Clear Inputs</button>
    </div>

  </div>
</div>


  <!-- CO inputs area (auto-generated based on numCOs) -->
  <div id="coSection" class="section">
    <div class="small">Per-CO inputs </code> — if not set, defaults to 4)</div>

    <div id="coGrid" class="co-grid" style="margin-top:12px;">
      <!-- headings and inputs inserted by JS -->
    </div>
  </div>

  <!-- Results -->
  <div id="resultsSection" class="section" style="display:none">
    <h3>Results</h3>
    <div id="resultTableWrap"></div>

    <div id="chartWrap">
      <canvas id="coChart" width="900" height="350"></canvas>
    </div>
  </div>

<h3>CO–PO Mapping</h3>
<div id="copotable"></div>

<br><button onclick="computePOAttainmentAndPlot()">Compute PO Attainment</button>

<h3>CO–PO / CO–PSO Mapping (With Final Attainment)</h3>
<table id="COPO_Output_Table" border="1" cellpadding="5"></table>

<div id="poresults"></div>



<canvas id="poChart" width="800" height="400"></canvas>


<button onclick="printAll()">Print</button>


</section>

<!-- SheetJS -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="obe.js"></script>
</body>
</html>
