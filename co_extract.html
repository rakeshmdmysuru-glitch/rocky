<!DOCTYPE html>
<html>
<head>
  <title>Dynamic CO Computation Tool</title>
<style>

</style>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

  <script src="script.js" defer></script>
</head>

<body class="bg-light">
<!-- Navigation Bar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">OBE System</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item">
          <a class="nav-link active" href="index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="obe.html">OBE Calculation</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="co_extract.html">CO Extraction</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
<div class="container mt-5">
  <div class="card shadow p-4">

    <h2 class="text-center mb-4 fw-bold text-primary">Dynamic CO Computation Tool</h2>

    <!-- Upload Excel -->
    <div class="mb-4">
      <label class="form-label fw-bold">Upload Excel File</label>
      <input type="file" id="excelFile" accept=".xlsx,.xls" class="form-control">
    </div>

    <h4 class="mt-4 fw-semibold">Enter CO Mapping for Q1 to Q15</h4>

    <!-- CO Table -->

    <table class="table table-bordered table-hover table-sm mt-3">
      <thead class="table-dark">
        <tr>
          <th>Question</th>
          <th>CO #</th>
        </tr>
      </thead>
      <tbody>
          <script>
    // create the 15 rows with inputs
    for (let i = 1; i <= 15; i++) {
      document.write(`
        <tr>
          <td class="fw-bold">Q${i}</td>
          <td>
            <input type="number" id="co_Q${i}" min="1" max="10"
                   class="form-control" />
          </td>
        </tr>
      `);
    }
  </script>
      </tbody>
    </table>

<script>
  // default values you want to auto-fill
  const defaultValues = "123451122334455".split(""); 
  // converts into: ["1","2","3","4","5","1","1","2","2","3","3","4","4","5","5"]

  window.onload = function() {
    for (let i = 1; i <= 15; i++) {
      const input = document.getElementById(`co_Q${i}`);
      input.value = defaultValues[i - 1];
    }
  };
</script>
    <!-- Buttons -->
    <div class="text-center mt-3">
      <button class="btn btn-primary btn-lg px-4" onclick="computeCOs()">Compute CO Results</button>
<!-- 
<div style="padding:8px; background:#f0f8ff; border-left:4px solid #0077cc; margin-bottom:10px;">
  <b>Note:</b> Upload any Excel file having student <b>USN</b> and <b>Name</b>.
</div>

<input type="file" id="detailsFile" />
<button class="btn btn-primary btn-lg px-4" onclick="addNameColumn()">Add Student Names</button>
</div>
-->
      <button class="btn btn-success btn-lg px-4 ms-3" onclick="exportToExcel()">Export to Excel</button>
    
<select id="sectionFilter">
  <option value="ALL">ALL</option>
</select>

<button class="btn btn-warning mt-3" onclick="sendResultsBackWithoutSection()">
  Send Results to obe sheet
</button>


    
    <div id="output" class="table-responsive"></div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
