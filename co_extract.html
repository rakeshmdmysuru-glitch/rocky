<!DOCTYPE html>
<html>
<head>
  <title>Dynamic CO Computation Tool</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="script.js" defer></script>
</head>

<body class="bg-light">

<div class="container mt-5">
  <div class="card shadow p-4">

    <h2 class="text-center mb-4 fw-bold text-primary">Dynamic CO Computation Tool</h2>

    <!-- Upload Excel -->
    <div class="mb-4">
      <label class="form-label fw-bold">Upload Excel File</label>
      <input type="file" id="excelFile" accept=".xlsx,.xls" class="form-control">
    </div>

    <h4 class="mt-4 fw-semibold">Enter CO Mapping for Q1 to Q15</h4>

    <!-- CO Table -->
    <table class="table table-bordered table-hover table-sm mt-3">
      <thead class="table-dark">
        <tr>
          <th>Question</th>
          <th>CO #</th>
        </tr>
      </thead>
      <tbody>
        <script>
          for(let i=1;i<=15;i++){
            document.write(`
              <tr>
                <td class="fw-bold">Q${i}</td>
                <td><input type="number" id="co_Q${i}" min="1" max="10" placeholder="Enter CO value" class="form-control" /></td>
              </tr>
            `);
          }
        </script>
      </tbody>
    </table>

    <!-- Buttons -->
    <div class="text-center mt-3">
      <button class="btn btn-primary btn-lg px-4" onclick="computeCOs()">Compute CO Results</button>
<div style="padding:8px; background:#f0f8ff; border-left:4px solid #0077cc; margin-bottom:10px;">
  <b>Note:</b> Upload any Excel file having student <b>USN</b> and <b>Name</b>.
</div>
<input type="file" id="detailsFile" />
<button class="btn btn-primary btn-lg px-4" onclick="addNameColumn()">Add Student Names</button>

      <button class="btn btn-success btn-lg px-4 ms-3" onclick="exportToExcel()">Export to Excel</button>
    </div>

    <hr class="my-4">

    <!-- Results Area -->
    <div id="output" class="table-responsive"></div>
  </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
